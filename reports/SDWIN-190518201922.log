Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/usr/local/lib/python3.8/site-packages/nbclient/client.py", line 1082, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/usr/local/lib/python3.8/site-packages/nbclient/util.py", line 74, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/usr/local/lib/python3.8/site-packages/nbclient/util.py", line 53, in just_run
    return loop.run_until_complete(coro)
  File "/usr/local/Cellar/python@3.8/3.8.8_1/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/usr/local/lib/python3.8/site-packages/nbclient/client.py", line 535, in async_execute
    await self.async_execute_cell(
  File "/usr/local/lib/python3.8/site-packages/nbclient/client.py", line 827, in async_execute_cell
    self._check_raise_for_error(cell, exec_reply)
  File "/usr/local/lib/python3.8/site-packages/nbclient/client.py", line 735, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply['content'])
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
df = spark.sql(
'''
SELECT Hostname,Channel,EventID, Count(*) as count
FROM mordorTable
GROUP BY Hostname,Channel,EventID
ORDER BY count DESC
'''
)
df.show(truncate=False)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mAnalysisException[0m                         Traceback (most recent call last)
[0;32m<ipython-input-3-114c2aede46d>[0m in [0;36m<module>[0;34m[0m
[0;32m----> 1[0;31m df = spark.sql(
[0m[1;32m      2[0m '''
[1;32m      3[0m [0mSELECT[0m [0mHostname[0m[0;34m,[0m[0mChannel[0m[0;34m,[0m[0mEventID[0m[0;34m,[0m [0mCount[0m[0;34m([0m[0;34m*[0m[0;34m)[0m [0;32mas[0m [0mcount[0m[0;34m[0m[0;34m[0m[0m
[1;32m      4[0m [0mFROM[0m [0mmordorTable[0m[0;34m[0m[0;34m[0m[0m
[1;32m      5[0m [0mGROUP[0m [0mBY[0m [0mHostname[0m[0;34m,[0m[0mChannel[0m[0;34m,[0m[0mEventID[0m[0;34m[0m[0;34m[0m[0m

[0;32m/var/lib/spark/python/pyspark/sql/session.py[0m in [0;36msql[0;34m(self, sqlQuery)[0m
[1;32m    644[0m         [0;34m[[0m[0mRow[0m[0;34m([0m[0mf1[0m[0;34m=[0m[0;36m1[0m[0;34m,[0m [0mf2[0m[0;34m=[0m[0;34mu'row1'[0m[0;34m)[0m[0;34m,[0m [0mRow[0m[0;34m([0m[0mf1[0m[0;34m=[0m[0;36m2[0m[0;34m,[0m [0mf2[0m[0;34m=[0m[0;34mu'row2'[0m[0;34m)[0m[0;34m,[0m [0mRow[0m[0;34m([0m[0mf1[0m[0;34m=[0m[0;36m3[0m[0;34m,[0m [0mf2[0m[0;34m=[0m[0;34mu'row3'[0m[0;34m)[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[1;32m    645[0m         """
[0;32m--> 646[0;31m         [0;32mreturn[0m [0mDataFrame[0m[0;34m([0m[0mself[0m[0;34m.[0m[0m_jsparkSession[0m[0;34m.[0m[0msql[0m[0;34m([0m[0msqlQuery[0m[0;34m)[0m[0;34m,[0m [0mself[0m[0;34m.[0m[0m_wrapped[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    647[0m [0;34m[0m[0m
[1;32m    648[0m     [0;34m@[0m[0msince[0m[0;34m([0m[0;36m2.0[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m/var/lib/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py[0m in [0;36m__call__[0;34m(self, *args)[0m
[1;32m   1302[0m [0;34m[0m[0m
[1;32m   1303[0m         [0manswer[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0mgateway_client[0m[0;34m.[0m[0msend_command[0m[0;34m([0m[0mcommand[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m-> 1304[0;31m         return_value = get_return_value(
[0m[1;32m   1305[0m             answer, self.gateway_client, self.target_id, self.name)
[1;32m   1306[0m [0;34m[0m[0m

[0;32m/var/lib/spark/python/pyspark/sql/utils.py[0m in [0;36mdeco[0;34m(*a, **kw)[0m
[1;32m    135[0m                 [0;31m# Hide where the exception came from that shows a non-Pythonic[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m    136[0m                 [0;31m# JVM exception message.[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 137[0;31m                 [0mraise_from[0m[0;34m([0m[0mconverted[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    138[0m             [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    139[0m                 [0;32mraise[0m[0;34m[0m[0;34m[0m[0m

[0;32m/var/lib/spark/python/pyspark/sql/utils.py[0m in [0;36mraise_from[0;34m(e)[0m

[0;31mAnalysisException[0m: cannot resolve '`Hostname`' given input columns: [mordorTable.@timestamp, mordorTable.AccessList, mordorTable.AccessMask, mordorTable.AccessReason, mordorTable.Application, mordorTable.AuthenticationPackageName, mordorTable.CallTrace, mordorTable.CommandLine, mordorTable.Company, mordorTable.ContextInfo, mordorTable.CreationUtcTime, mordorTable.CurrentDirectory, mordorTable.Description, mordorTable.DestAddress, mordorTable.DestPort, mordorTable.DestinationHostname, mordorTable.DestinationIp, mordorTable.DestinationIsIpv6, mordorTable.DestinationPort, mordorTable.DestinationPortName, mordorTable.Details, mordorTable.Direction, mordorTable.DisabledPrivilegeList, mordorTable.ElevatedToken, mordorTable.EnabledPrivilegeList, mordorTable.EventCountTotal, mordorTable.EventIdx, mordorTable.EventType, mordorTable.FileVersion, mordorTable.FilterRTID, mordorTable.GrantedAccess, mordorTable.GroupMembership, mordorTable.HandleId, mordorTable.Hashes, mordorTable.Image, mordorTable.ImageLoaded, mordorTable.ImpersonationLevel, mordorTable.Initiated, mordorTable.IntegrityLevel, mordorTable.IpAddress, mordorTable.IpPort, mordorTable.KeyLength, mordorTable.LayerName, mordorTable.LayerRTID, mordorTable.LmPackageName, mordorTable.LogonGuid, mordorTable.LogonId, mordorTable.LogonProcessName, mordorTable.LogonType, mordorTable.MandatoryLabel, mordorTable.NewProcessId, mordorTable.NewProcessName, mordorTable.NewSd, mordorTable.ObjectName, mordorTable.ObjectServer, mordorTable.ObjectType, mordorTable.OldSd, mordorTable.ParentCommandLine, mordorTable.ParentImage, mordorTable.ParentProcessGuid, mordorTable.ParentProcessId, mordorTable.ParentProcessName, mordorTable.Payload, mordorTable.PipeName, mordorTable.PreAuthType, mordorTable.PrivilegeList, mordorTable.ProcessGuid, mordorTable.ProcessID, mordorTable.ProcessId, mordorTable.ProcessName, mordorTable.Product, mordorTable.Protocol, mordorTable.RemoteMachineID, mordorTable.RemoteUserID, mordorTable.ResourceAttributes, mordorTable.RestrictedAdminMode, mordorTable.RestrictedSidCount, mordorTable.ServiceName, mordorTable.ServiceSid, mordorTable.ShareName, mordorTable.Signature, mordorTable.SignatureStatus, mordorTable.Signed, mordorTable.SourceAddress, mordorTable.SourceHandleId, mordorTable.SourceHostname, mordorTable.SourceImage, mordorTable.SourceIp, mordorTable.SourceIsIpv6, mordorTable.SourcePort, mordorTable.SourcePortName, mordorTable.SourceProcessGUID, mordorTable.SourceProcessId, mordorTable.SourceThreadId, mordorTable.Status, mordorTable.SubjectDomainName, mordorTable.SubjectLogonId, mordorTable.SubjectUserName, mordorTable.SubjectUserSid, mordorTable.TargetDomainName, mordorTable.TargetFilename, mordorTable.TargetHandleId, mordorTable.TargetImage, mordorTable.TargetLinkedLogonId, mordorTable.TargetLogonId, mordorTable.TargetObject, mordorTable.TargetOutboundDomainName, mordorTable.TargetOutboundUserName, mordorTable.TargetProcessGUID, mordorTable.TargetProcessId, mordorTable.TargetSid, mordorTable.TargetUserName, mordorTable.TargetUserSid, mordorTable.TerminalSessionId, mordorTable.TicketEncryptionType, mordorTable.TicketOptions, mordorTable.TokenElevationType, mordorTable.TransactionId, mordorTable.TransmittedServices, mordorTable.User, mordorTable.UtcTime, mordorTable.VirtualAccount, mordorTable.WorkstationName, mordorTable.channel, mordorTable.computer_name, mordorTable.event_id, mordorTable.message, mordorTable.param1, mordorTable.param2, mordorTable.param3, mordorTable.provider_name, mordorTable.record_id]; line 4 pos 9;
'Sort ['count DESC NULLS LAST], true
+- 'Aggregate ['Hostname, 'Channel, 'EventID], ['Hostname, 'Channel, 'EventID, count(1) AS count#782L]
   +- SubqueryAlias mordorTable
      +- Project [AccessList#126, AccessMask#127, AccessReason#128, Application#129, AuthenticationPackageName#130, CallTrace#131, CommandLine#132, Company#133, ContextInfo#134, CreationUtcTime#135, CurrentDirectory#136, Description#137, DestAddress#138, DestPort#139, DestinationHostname#140, DestinationIp#141, DestinationIsIpv6#142, DestinationPort#143, DestinationPortName#144, Details#145, Direction#146, DisabledPrivilegeList#147, ElevatedToken#148, EnabledPrivilegeList#149, ... 108 more fields]
         +- Project [AccessList#126, AccessMask#127, AccessReason#128, Application#129, AuthenticationPackageName#130, CallTrace#131, CommandLine#132, Company#133, ContextInfo#134, CreationUtcTime#135, CurrentDirectory#136, Description#137, DestAddress#138, DestPort#139, DestinationHostname#140, DestinationIp#141, DestinationIsIpv6#142, DestinationPort#143, DestinationPortName#144, Details#145, Direction#146, DisabledPrivilegeList#147, ElevatedToken#148, EnabledPrivilegeList#149, ... 108 more fields]
            +- Project [AccessList#126, AccessMask#127, AccessReason#128, Application#129, AuthenticationPackageName#130, CallTrace#131, CommandLine#132, Company#133, ContextInfo#134, CreationUtcTime#135, CurrentDirectory#136, Description#137, DestAddress#138, DestPort#139, DestinationHostname#140, DestinationIp#141, DestinationIsIpv6#142, DestinationPort#143, DestinationPortName#144, Details#145, Direction#146, DisabledPrivilegeList#147, ElevatedToken#148, EnabledPrivilegeList#149, ... 108 more fields]
               +- Project [event_data#12.AccessList AS AccessList#126, event_data#12.AccessMask AS AccessMask#127, event_data#12.AccessReason AS AccessReason#128, event_data#12.Application AS Application#129, event_data#12.AuthenticationPackageName AS AuthenticationPackageName#130, event_data#12.CallTrace AS CallTrace#131, event_data#12.CommandLine AS CommandLine#132, event_data#12.Company AS Company#133, event_data#12.ContextInfo AS ContextInfo#134, event_data#12.CreationUtcTime AS CreationUtcTime#135, event_data#12.CurrentDirectory AS CurrentDirectory#136, event_data#12.Description AS Description#137, event_data#12.DestAddress AS DestAddress#138, event_data#12.DestPort AS DestPort#139, event_data#12.DestinationHostname AS DestinationHostname#140, event_data#12.DestinationIp AS DestinationIp#141, event_data#12.DestinationIsIpv6 AS DestinationIsIpv6#142, event_data#12.DestinationPort AS DestinationPort#143, event_data#12.DestinationPortName AS DestinationPortName#144, event_data#12.Details AS Details#145, event_data#12.Direction AS Direction#146, event_data#12.DisabledPrivilegeList AS DisabledPrivilegeList#147, event_data#12.ElevatedToken AS ElevatedToken#148, event_data#12.EnabledPrivilegeList AS EnabledPrivilegeList#149, ... 108 more fields]
                  +- Filter ((beat_type#79 = winlogbeat) AND (cast(version#54 as int) <= 6))
                     +- Project [@metadata#7, @timestamp#8, activity_id#9, beat#10, computer_name#11, event_data#12, event_id#13L, host#14, keywords#15, level#16, log_name#17, message#18, opcode#19, process_id#20L, provider_guid#21, record_number#22, source_name#23, task#24, thread_id#25L, type#26, user#27, user_data#28, version#54, @metadata#7.beat AS beat_type#79]
                        +- Project [@metadata#7, @timestamp#8, activity_id#9, beat#10, computer_name#11, event_data#12, event_id#13L, host#14, keywords#15, level#16, log_name#17, message#18, opcode#19, process_id#20L, provider_guid#21, record_number#22, source_name#23, task#24, thread_id#25L, type#26, user#27, user_data#28, substring(@metadata#7.version, 1, 1) AS version#54]
                           +- Relation[@metadata#7,@timestamp#8,activity_id#9,beat#10,computer_name#11,event_data#12,event_id#13L,host#14,keywords#15,level#16,log_name#17,message#18,opcode#19,process_id#20L,provider_guid#21,record_number#22,source_name#23,task#24,thread_id#25L,type#26,user#27,user_data#28,version#29L] json

AnalysisException: cannot resolve '`Hostname`' given input columns: [mordorTable.@timestamp, mordorTable.AccessList, mordorTable.AccessMask, mordorTable.AccessReason, mordorTable.Application, mordorTable.AuthenticationPackageName, mordorTable.CallTrace, mordorTable.CommandLine, mordorTable.Company, mordorTable.ContextInfo, mordorTable.CreationUtcTime, mordorTable.CurrentDirectory, mordorTable.Description, mordorTable.DestAddress, mordorTable.DestPort, mordorTable.DestinationHostname, mordorTable.DestinationIp, mordorTable.DestinationIsIpv6, mordorTable.DestinationPort, mordorTable.DestinationPortName, mordorTable.Details, mordorTable.Direction, mordorTable.DisabledPrivilegeList, mordorTable.ElevatedToken, mordorTable.EnabledPrivilegeList, mordorTable.EventCountTotal, mordorTable.EventIdx, mordorTable.EventType, mordorTable.FileVersion, mordorTable.FilterRTID, mordorTable.GrantedAccess, mordorTable.GroupMembership, mordorTable.HandleId, mordorTable.Hashes, mordorTable.Image, mordorTable.ImageLoaded, mordorTable.ImpersonationLevel, mordorTable.Initiated, mordorTable.IntegrityLevel, mordorTable.IpAddress, mordorTable.IpPort, mordorTable.KeyLength, mordorTable.LayerName, mordorTable.LayerRTID, mordorTable.LmPackageName, mordorTable.LogonGuid, mordorTable.LogonId, mordorTable.LogonProcessName, mordorTable.LogonType, mordorTable.MandatoryLabel, mordorTable.NewProcessId, mordorTable.NewProcessName, mordorTable.NewSd, mordorTable.ObjectName, mordorTable.ObjectServer, mordorTable.ObjectType, mordorTable.OldSd, mordorTable.ParentCommandLine, mordorTable.ParentImage, mordorTable.ParentProcessGuid, mordorTable.ParentProcessId, mordorTable.ParentProcessName, mordorTable.Payload, mordorTable.PipeName, mordorTable.PreAuthType, mordorTable.PrivilegeList, mordorTable.ProcessGuid, mordorTable.ProcessID, mordorTable.ProcessId, mordorTable.ProcessName, mordorTable.Product, mordorTable.Protocol, mordorTable.RemoteMachineID, mordorTable.RemoteUserID, mordorTable.ResourceAttributes, mordorTable.RestrictedAdminMode, mordorTable.RestrictedSidCount, mordorTable.ServiceName, mordorTable.ServiceSid, mordorTable.ShareName, mordorTable.Signature, mordorTable.SignatureStatus, mordorTable.Signed, mordorTable.SourceAddress, mordorTable.SourceHandleId, mordorTable.SourceHostname, mordorTable.SourceImage, mordorTable.SourceIp, mordorTable.SourceIsIpv6, mordorTable.SourcePort, mordorTable.SourcePortName, mordorTable.SourceProcessGUID, mordorTable.SourceProcessId, mordorTable.SourceThreadId, mordorTable.Status, mordorTable.SubjectDomainName, mordorTable.SubjectLogonId, mordorTable.SubjectUserName, mordorTable.SubjectUserSid, mordorTable.TargetDomainName, mordorTable.TargetFilename, mordorTable.TargetHandleId, mordorTable.TargetImage, mordorTable.TargetLinkedLogonId, mordorTable.TargetLogonId, mordorTable.TargetObject, mordorTable.TargetOutboundDomainName, mordorTable.TargetOutboundUserName, mordorTable.TargetProcessGUID, mordorTable.TargetProcessId, mordorTable.TargetSid, mordorTable.TargetUserName, mordorTable.TargetUserSid, mordorTable.TerminalSessionId, mordorTable.TicketEncryptionType, mordorTable.TicketOptions, mordorTable.TokenElevationType, mordorTable.TransactionId, mordorTable.TransmittedServices, mordorTable.User, mordorTable.UtcTime, mordorTable.VirtualAccount, mordorTable.WorkstationName, mordorTable.channel, mordorTable.computer_name, mordorTable.event_id, mordorTable.message, mordorTable.param1, mordorTable.param2, mordorTable.param3, mordorTable.provider_name, mordorTable.record_id]; line 4 pos 9;
'Sort ['count DESC NULLS LAST], true
+- 'Aggregate ['Hostname, 'Channel, 'EventID], ['Hostname, 'Channel, 'EventID, count(1) AS count#782L]
   +- SubqueryAlias mordorTable
      +- Project [AccessList#126, AccessMask#127, AccessReason#128, Application#129, AuthenticationPackageName#130, CallTrace#131, CommandLine#132, Company#133, ContextInfo#134, CreationUtcTime#135, CurrentDirectory#136, Description#137, DestAddress#138, DestPort#139, DestinationHostname#140, DestinationIp#141, DestinationIsIpv6#142, DestinationPort#143, DestinationPortName#144, Details#145, Direction#146, DisabledPrivilegeList#147, ElevatedToken#148, EnabledPrivilegeList#149, ... 108 more fields]
         +- Project [AccessList#126, AccessMask#127, AccessReason#128, Application#129, AuthenticationPackageName#130, CallTrace#131, CommandLine#132, Company#133, ContextInfo#134, CreationUtcTime#135, CurrentDirectory#136, Description#137, DestAddress#138, DestPort#139, DestinationHostname#140, DestinationIp#141, DestinationIsIpv6#142, DestinationPort#143, DestinationPortName#144, Details#145, Direction#146, DisabledPrivilegeList#147, ElevatedToken#148, EnabledPrivilegeList#149, ... 108 more fields]
            +- Project [AccessList#126, AccessMask#127, AccessReason#128, Application#129, AuthenticationPackageName#130, CallTrace#131, CommandLine#132, Company#133, ContextInfo#134, CreationUtcTime#135, CurrentDirectory#136, Description#137, DestAddress#138, DestPort#139, DestinationHostname#140, DestinationIp#141, DestinationIsIpv6#142, DestinationPort#143, DestinationPortName#144, Details#145, Direction#146, DisabledPrivilegeList#147, ElevatedToken#148, EnabledPrivilegeList#149, ... 108 more fields]
               +- Project [event_data#12.AccessList AS AccessList#126, event_data#12.AccessMask AS AccessMask#127, event_data#12.AccessReason AS AccessReason#128, event_data#12.Application AS Application#129, event_data#12.AuthenticationPackageName AS AuthenticationPackageName#130, event_data#12.CallTrace AS CallTrace#131, event_data#12.CommandLine AS CommandLine#132, event_data#12.Company AS Company#133, event_data#12.ContextInfo AS ContextInfo#134, event_data#12.CreationUtcTime AS CreationUtcTime#135, event_data#12.CurrentDirectory AS CurrentDirectory#136, event_data#12.Description AS Description#137, event_data#12.DestAddress AS DestAddress#138, event_data#12.DestPort AS DestPort#139, event_data#12.DestinationHostname AS DestinationHostname#140, event_data#12.DestinationIp AS DestinationIp#141, event_data#12.DestinationIsIpv6 AS DestinationIsIpv6#142, event_data#12.DestinationPort AS DestinationPort#143, event_data#12.DestinationPortName AS DestinationPortName#144, event_data#12.Details AS Details#145, event_data#12.Direction AS Direction#146, event_data#12.DisabledPrivilegeList AS DisabledPrivilegeList#147, event_data#12.ElevatedToken AS ElevatedToken#148, event_data#12.EnabledPrivilegeList AS EnabledPrivilegeList#149, ... 108 more fields]
                  +- Filter ((beat_type#79 = winlogbeat) AND (cast(version#54 as int) <= 6))
                     +- Project [@metadata#7, @timestamp#8, activity_id#9, beat#10, computer_name#11, event_data#12, event_id#13L, host#14, keywords#15, level#16, log_name#17, message#18, opcode#19, process_id#20L, provider_guid#21, record_number#22, source_name#23, task#24, thread_id#25L, type#26, user#27, user_data#28, version#54, @metadata#7.beat AS beat_type#79]
                        +- Project [@metadata#7, @timestamp#8, activity_id#9, beat#10, computer_name#11, event_data#12, event_id#13L, host#14, keywords#15, level#16, log_name#17, message#18, opcode#19, process_id#20L, provider_guid#21, record_number#22, source_name#23, task#24, thread_id#25L, type#26, user#27, user_data#28, substring(@metadata#7.version, 1, 1) AS version#54]
                           +- Relation[@metadata#7,@timestamp#8,activity_id#9,beat#10,computer_name#11,event_data#12,event_id#13L,host#14,keywords#15,level#16,log_name#17,message#18,opcode#19,process_id#20L,provider_guid#21,record_number#22,source_name#23,task#24,thread_id#25L,type#26,user#27,user_data#28,version#29L] json


